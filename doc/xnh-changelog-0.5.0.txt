xNetHack 0.5.0 Changelog

This is a minor version of xNetHack. It is a fork off of the vanilla NetHack
3.6.2 development version release, and is also based directly on xNetHack 0.4.1.
It will continue to contain all of the latest commits pushed by the vanilla
devteam on their 3.6.2 branch; see doc/fixes36.2 for these changes.

The xNetHack page at the NetHackWiki, https://nethackwiki.com/wiki/XNetHack,
attempts to describe these changes in a way that's better formatted and more
friendly to players. However, the wiki page might be out of date; in case of
conflicting rnformation, this changelog and others in this directory are more
up-to-date than the wiki page, and the commit messages are more up-to-date than
this changelog.

On top of any changes made by the NetHack devteam on 3.6.1, and any changes
made in previous xNetHack versions, xNetHack 0.5.0 contains the following
gameplay changes:

You can sometimes recover from food poisoning with a Con/100 chance.
If you have hungerless casting, you will never be too hungry to cast a spell.
Corpses dropped by zombies can revive on their own.
When you are killed by a zombie, you will arise from the grave as one in bones
  (25% chance to keep playing as a zombie, similar to other undead).
When a zombie or lich kills a monster that has a zombie counterpart in melee, it
  resurrects as a zombie that is either tame or hostile depending on the
  attacking zombie.
Zombies will grudge monsters that they can zombify, and vice versa.
The pet-off-level-untaming timer is fuzzed so it's not totally predictable.
Pets' willingness to attack foes of a certain level decreases linearly with
  their hit point percentage.
Trees can generate in the rooms of room-and-corridor levels.
Lord monsters' weapons and armor is never negatively enchanted.
If you're carrying sufficient food, being Weak isn't a major trouble.
If you're turning to slime and opening a tin of chameleon meat, you won't be
  interrupted (you could turn into something fiery).
Blessed potions of hallucination grant enlightenment 50% of the time; cursed
  ones do 20% of the time, uncursed ones never do.
Grimtooth is now permanently poisoned and has a base cost of 1000.
Poisoned weapons in melee do d10+6 damage to non-resistant creatures, but only
  25% of the time.
Dragonbane now gives vision of dragons when wielded and does +d10 damage to
  dragons. Its cost is raised to 2500.
Demonbane now gives vision of demons when wielded, glowing white.
Werebane now gives vision of weres when wielded and does +d10 damage to weres.
Giantslayer now gives vision of giants when wielded and does +d10 damage to
  giants. Its cost is raised to 500.
Trollsbane now gives hungerless regeneration when wielded, gives vision of
trolls when wielded, and does +d10 damage to trolls. Its cost is raised to 1000.
Ogresmasher's cost is raised to 1200.
Sitting or manually teleporting via ^T while standing on a known level
  teleporter will activate it, bypassing magic resistance.
Intelligent monsters in the Castle know about the trapdoors.
Reading a confused scroll of earth will summon earth elementals and dust
  vortices rather than mostly harmless rocks.
Hobbits may generate carrying produce.
Fire Brand instakills flammable golems and green slimes
Elven items use their base material 60% of the time and become wood 20% of the
  time rather than defaulting to wood 80% of the time.
The throne monster in throne rooms has a shiny expensive mace rather than a
  boring iron one.
The Bell of Opening will turn into a silver regular bell in a bones file, rather
  than a copper one.
All types of orc monsters (all o) resist poison.
Pets won't fight each other even if they grudge each other.
Port RPresser's epitaph patch, enabling you to write your own gravestone text.
Wizard mode players now always get the option to leave bones unless the level is
  ineligible.
Monsters can gain intrinsics from corpses they eat, identically to players,
  except that they can currently only get resistance-type intrinsics and
  telepathy. The only non-pet monster that can currently eat corpses is the
  gelatinous cube.
Dragons will roar of their own accord from time to time, which wakes nearby
  monsters.
Implement cooperative telepathy: if you have any sort of telepathy, even
  extrinsic and you are not blind, you are able to see telepathic monsters.
Pets will attack monsters they grudge even if they are of too high a level.
Pets will not attack gas spores that you're adjacent to.
Magic-liking monsters will pick up all magical items, not just objects from
  classes where all items are magical.
Monsters can use magic flutes.
Dissolving a cursed mold corpse in fruit juice will create sickness.
Port the Free Fortune Cookie Patch: half of szechuan tins, if eaten, give you a
  free fortune cookie.
Getting a critical hit on a vampire with a wooden piercing weapon can stake it
through the heart and destroy it instantly.
Magic lamps always release a djinni when rubbed instead of 1/3 of the time.
Hallucination protects fully versus the gaze attack of floating eyes.
1/30 of randomly generated tins are booby-trapped and will explode when opened.
1/5 of nurses carry a scalpel.
Wearing a charged ring of carrying will auto-identify it.
Hobbits and Nazguls grudge each other.
All s-class monsters grudge x-class and a-class monsters, but not vice versa.
Bats grudge all flying x-class and a-class monsters (currently just bees).
Guarantee graffiti of a true rumor in the first room of the dungeon.
When hallucinating, all rays appear as blasts of something nonsensical.
Rings that aren't obviously iron by their appearance are made of metal instead.
Helms made of wood, bone and stone protect your head the same as a metal helm.
Helms made of glass may be shattered if a heavy object drops on them.
Helms reduce a lot less of the damage if the falling object is very heavy.
Helms only protect you from half of the damage from a falling piercer.
Acidic corpses can go moldy, but produce only green mold.
Plastic has a much lower relative cost as a material.
Group size now throttles on low dungeon levels rather than experience levels.
Glass body armor may shatter if you are hit with a heavy object moving sideways.
Hallucination is now effective against all gaze attacks made by monsters.
Falling rock traps no longer generate on outdoors levels.


It contains the following non-gameplay interface changes:

Potion bottles are called by nonsensical names when hallucinating.
Your god will belch, bray, squeak, and so on instead of booming or thundering
  while you are hallucinating.
Confused scrolls of fire underwater evaporate the water like a regular scroll.
A message is printed when you fail to walk into liquid, and the first time this
  happens in the game it informs you that you can use m to walk in.
Add a new paranoid confirmation option "throw"; when on, it prompts for
  confirmation when you try to throw ammo with no matching launcher for it.
Dwarves think all rats are delicious.
YAFM for hearing a dwarf digging while hallucinating.
YAFM for eating long worms.
YAFM for dying to green slime (permanently) while hallucinating.
YAFM for failing to get a wished-for artifact while hallucinating.
YAFM for ascending while hallucinating.
YAFM for trying to #chat to a wall.
YAFM for a cosmetic magic trap effect if you are a hallucinating valkyrie.
YAFM for hearing a wererat change form while hallucinating.
YAFM for getting your brains eaten while hallucinating.
Usual periodic assortment of new bogusmons, bogus gods, bogus currencies, candy
  bar labels, t-shirt texts, rumors, engravings, and epitaphs.
Give better directions for reporting impossible() calls.
Give gnomes a gnomeish message when chatted to.
Auto-identify a potion of acid when it explodes due to water contact.
Add L's Colored Walls Patch, turning the walls in various special levels and
  branches different colors. Also in some types of special rooms.
Don't unconditionally delete the save file in case of a version mismatch.
Zombies groan instead of being silent.
Trying to attack a monster in melee with pacifist conduct intact after 100 turns
  will ask you if you really want to attack.
Livelog when the player changes alignment (by helm or permaconversion).
YAFM for staking a vampire's heart while hallucinating.
You can try indefinitely to enter a valid wish, rather than the game giving you
  a random object after 5 failed tries.
YAFM for hitting a devil with an egg (thrown or melee).
Message that you can't reenter the dungeon after negative levelport
Give a special artifact message when Grimtooth poisons a target.


It contains the following non-gameplay architectural changes:

Refactor spell hunger reduction logic into its own function.
Refactor confusing logic of what food adjective to choose.
Promote obj_nutrition to a non-static function.
Allow artifacts which target a monster class (S_* instead of M2_*) to warn
  versus that monster class. The save-stable version of this is kludgy.
Change all obj->material = foo statements into a function set_material which
  handles weight recalculation and erosion differences between the materials.
Move bones depth logic out of can_make_bones into really_done.
Move corpse-intrinsic-selection logic into its own function.
Extract part of givit's logic (the yes/no of whether an intrinsic should be
  given) into its own function.
Define a new MR2_TELEPATHY monster intrinsic and set it by default for all
  inherently-telepathic monsters.
Add a parameter to put_monsters_to_sleep defining the monster that is causing
  the effect.
Refactor mpickstuff to use a callback function rather than a string of object
  classes, allowing for finer control of objects monsters will pick up.
Refactor mm_aggression into clear one-directional and two-directional cases.
Pass lines retrieved via get_rnd_text and get_rumor (rumors, bogusmons,
  graffiti, epitaphs, etc) through the quest text parser, letting them use %
  arguments.
Move angelic and demonic maledictions out of quest.txt into wizard.c string
  constants, and scrap using com_pager for them.
